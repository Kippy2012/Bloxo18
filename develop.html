<!DOCTYPE html>
<html>
<head>
  <title>Develop â€“ Bloxo 18</title>
  <link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      padding: 0;
      background-color: #57aaff;
      font-family: Arial, sans-serif;
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding-top: 40px;
    }

    .logo {
      font-family: 'Luckiest Guy', cursive;
      font-size: 70px;
      text-shadow: -3px -3px 0 red, 3px -3px 0 red, -3px 3px 0 red, 3px 3px 0 red;
      margin-bottom: 20px;
    }

    form {
      background: white;
      color: black;
      padding: 20px;
      border-radius: 10px;
      width: 300px;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    input {
      width: 100%;
      padding: 10px;
      font-size: 16px;
    }

    button {
      padding: 10px;
      font-size: 16px;
      background: green;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    .logout {
      margin-top: 30px;
      background: red;
      color: white;
      padding: 10px 20px;
      border: none;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <div class="logo">Bloxo 18</div>
  <h2>Create a Game</h2>

  <form id="gameForm">
    <input type="text" id="title" placeholder="Game Title" required>
    <input type="text" id="image" placeholder="Image URL" required>
    <input type="file" id="rbxlFile" accept=".rbxl" required>
    <button type="submit">Publish</button>
  </form>

  <button class="logout" onclick="logout()">Logout</button>

  <script>
    try {
      const userRaw = localStorage.getItem("blox18_user");
      if (!userRaw) throw new Error("Not logged in");
      const user = JSON.parse(userRaw);

      const form = document.getElementById("gameForm");
      form.onsubmit = async (e) => {
        e.preventDefault();

        const title = document.getElementById("title").value.trim();
        const image = document.getElementById("image").value.trim();
        const fileInput = document.getElementById("rbxlFile");
        const file = fileInput.files[0];

        if (!title || !image || !file) {
          alert("Please fill in all fields and upload a .rbxl file!");
          return;
        }

        const fileURL = URL.createObjectURL(file);

        const newGame = {
          title,
          image,
          creator: user.username,
          rbxl: fileURL,
          rbxlName: file.name
        };

        const games = JSON.parse(localStorage.getItem("blox18_games") || "[]");
        games.push(newGame);
        localStorage.setItem("blox18_games", JSON.stringify(games));

        alert("Game published!");
        form.reset();
      };
    } catch (e) {
      alert("You must be logged in!");
      window.location.href = "login.html";
    }

    function logout() {
      localStorage.removeItem("blox18_user");
      window.location.href = "login.html";
    }
  </script>

</body>
</html>
